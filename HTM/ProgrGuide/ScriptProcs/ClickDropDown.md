---
layout: page
title: "Системное событие документа ClickDropDown"
---

[См. также](../scriptstproced.md)  Пример  [Применяется к](../Defs/doc.html)

В некоторых случаях, при выборе значений реквизитов документа типа [Tree()](../Types/Tree().html), [FullTree()](../Types/FULLTREE().html), [Folder()](../Types/Folder().html) необходимо приводить не весь список одноуровневого дерева или папки, а некоторое его отфильтрованное подмножество. Этого можно достичь в обработчике системного события **ClickDropDown**, если генерация данного события [разрешена](../Functions/ASDOC/ClickDropDownEvent.html) ядром системы. В обработчике события нужно создать экземпляр [объекта типа произвольный вспомогательный список](../Functions/AsModalBrowser.html), который и будет появляться при нажатии кнопки выбора значения реквизита. Т.о. в результате нажатия кнопки выбора будет приводиться не папка, указанная в описании реквизита, а отфильтрованный вспомогательный список. Данное событие может генерироваться также для числовых типов [Summa](../Types/Summa.html), [SummaP](../Types/Summap.html), [N()](../Types/N().html), [NP()](../Types/Np().html), [CH()](../Types/Ch().html) (например для выбора партий товара на количестве).

## Синтаксис

``` vb
Sub ClickDropDown(ByVal Rekv As String, ByVal Top As Stingle, ByVal Left As Stingle, Optional ByVal lookupValue As Variant)
```

Синтаксис события **ClickDropDown** состоит из следующих частей:

|Параметр|Описание|
|--|--|
|`Rekv`|строковое выражение, определяющее идентификатор реквизита в документе, для которого сгенерировано данное событие.|
|`Top`|выражение типа Single, определяющее расстояние между верхним краем вспомогательного списка и верхним краем формы документа.|
|`Left`|выражение типа Single, определяющее расстояние между левым краем вспомогательного списка и левым краем формы документа.|
|`lookupValue`|необязательное строковое выражение, для передачи в качестве поискового [значения](../Functions/AsModalBrowser/LookUpValue.html) параметра в [искомой колонке](../Functions/AsModalBrowser/LookUpColumn.html). Данный параметр используется для установки маркера на строку с указанным значением при наборе с клавиатуры. Тип поиска должен быть установлен с помощью свойства [LookUpSoftMode](../Functions/AsModalBrowser/LookUpSoftMode.html).|
