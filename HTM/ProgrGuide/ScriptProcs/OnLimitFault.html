---
layout: page
title: "Системное событие OnLimitFault"
---





<p><strong>Событие OnLimitFault<br>
<br>
</strong><a href="../scriptstproced.html">См. также</a>&nbsp; <u>Пример</u>&nbsp; <a href="../Defs/Accounting.html">Применяется к</a></p>

<p>Генерируется при неудачной проверке лимитов, наложенных на объект учета, при использовании методов документа <a href="../Functions/ASDOC/CheckAndStore.html">CheckAndStore</a>, <a href="../Functions/ASDOC/HiDelete.html">HiDelete</a>. В обработчике данного события удобно выдавать сообщения об ошибках при нарушении допустимых границ остатков объекта. При аккумулирующем объекте учета событие также возвращает признак того нужно ли игнорировать данное событие или нет.</p>

<p>&nbsp;</p>

<p><b>Синтаксис</b></p>

<p>Для учетов работaющиx с HI без связаноого учета:</p>

<p>Function <strong>OnLimitFault</strong>(<em>nISN</em>,
<i>nOverrunning, </i>[<i>bDeleteDoc</i>, <i>oDoc</i>])<br>
<em>&nbsp;&nbsp; statements</em><br>
End Function</p>

<p>Для учетов работaющиx с HI со связаным учетом:</p>

<p>Function <strong>OnLimitFault</strong>(<em>nISN</em>,
<i>nOverrunning, nOverrunningLinked, bDeleteDoc</i>, <i>oDoc</i>)<br>
<em>&nbsp;&nbsp; statements</em><br>
End Function</p>

<p>Для учетов работaющиx с HI2:</p>

<p>Sub <strong>OnLimitFault</strong>(<em>nISN</em>, [<em>nGLISN</em>], [<i>bDeleteDoc</i>, <i>oDoc</i>])<br>
<em>&nbsp;&nbsp; statements</em><br>
End Sub</p>

<p>Синтаксис события <strong>OnLimitFault</strong>
состоит из следующих частей:</p>

<table border="1" cellPadding="5" cols="2" frame="below" rules="rows">
<TBODY>
  <tr>
    <td><b>Параметр</b></td>
    <td><strong>Описание</strong></td>
  </tr>
  <tr>
    <td><em>nISN</em></td>
    <td>численное выражение, определяющее ISN объекта учета</td>
  </tr>
  <tr>
    <td><em>nGLISN</em></td>
    <td>численное выражение, определяющее ISN аккумулирующего объекта учета. Данный параметр необходим для проверки лимитов в таблице HIREST2.</td>
  </tr>
    <tr>
    <td><i>nOverrunning</i></td>
    <td>численное выражение, определяющее величину выхода из пределов. Если значение отрицательно то имел место выход за рамки нижнего прeдела. При положительной величине имел место выход за рамки верхнего прeдела. </td>
    </tr>
  <tr>
    <td>
<i>nOverrunningLinked</i></td>
    <td>численное выражение, определяющее величину выхода из пределов связаного учета.</td>
  </tr>
  <tr>
    <td><i>bDeleteDoc</i></td>
    <td>логическое выражение, определяющее признак того, возникла ли проверка во время удаления документа или нет. </td>
  </tr>
  <tr>
    <td><i>oDoc</i></td>
    <td>объект
    <a href="../Functions/Asdoc.html">документ</a>, определяющее документ генерировавшее данное событие.</td>
  </tr>
</table>


