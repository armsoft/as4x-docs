---
layout: page
title: "AsErrorsFreeExecutor"
---
<style type="text/css">
.style1 {
	font-family: Arial;
}
</style>





<p><strong>Пример методов <span>Run </span>и 
<span>SetErrSubParams</span></strong></p>

<p>В примере вызывается функция 
<a href="../Functions/Functions/CreateErrorsFreeExecutor.html">
CreateErrorsFreeExecutor</a>, задаются имена скриптовых процедур (<span><em>SubName</em>-</span>имя исполняемой процедуры,&nbsp; <em>Err</em><span><em>SubName</em></span>-имя процедуры, которая вызывается только при возникновении ошибки во время исполнения<span> <em>SubName</em></span>). Устанавливается отчет
<span>(</span><strong>RepViewer</strong><span>)</span> в котором сохраняются все сообщения об ошибках<span>. </span>Далее, в цикле выполняется процедура <span><em>SubName</em></span> при помощи метода <strong>Run.</strong> Перед вызовом метода <strong>Run </strong>
передаются параметры для процедуры <em>Err</em><span><em>SubName</em></span> при помощи метода <strong>SetErrSubParams</strong>.</p>

<p>Set errFee =
<a href="../Functions/Functions/CreateErrorsFreeExecutor.html">
CreateErrorsFreeExecutor</a>(&quot;<span>ModuleName</span>&quot;, &quot;<span>SubName</span>&quot;, &quot;Err<span>SubName</span>&quot;)<br>
Set errRep = <a href="../Functions/Functions/CreateRepViewer.html">
CreateRepViewer</a><br>
Set errFee.<strong>RepViewer</strong> = errRep<br>
<strong>....</strong><br>
Set rs = Util.ExecuteQuery(sSql, True, ASOpenKeyset, , , 6000)<br>
Do While Not rs.EOF<br>
&nbsp;&nbsp;&nbsp; i += 1<br>
&nbsp;&nbsp;&nbsp; <strong>....</strong><br>
&nbsp;&nbsp;&nbsp; errFee.<strong>SetErrSubParams </strong>(i, docAgr, errRep)<br>
&nbsp;&nbsp;&nbsp; errFee.<strong>Run </strong>(docAgr)<br>
<br>
&nbsp;&nbsp;&nbsp; <span>rs</span>.MoveNext<br>
Loop <br>
<span>rs.close</span><br>
</p>
<p>Ниже приведены сигнатуры процедур <span><em>
SubName</em></span> и <span><em>ErrSubName</em></span>.</p>
<p><span><span>Public Sub</span> </span>
<span><em>SubName</em></span> (<span>ByVal docAgr As AsDoc</span>)<span><span><br>
Public Sub <em>ErrSubName</em></span> <span>(ByVal lErrNumber As Long, ByVal docAgr As AsDoc, ByVal errRep as AsRepViewer)</span></span></p>
<p>Если параметры для процедуры <em>Err</em><em><span>SubName</span>
</em>не переданы методом <strong>SetErrSubParams</strong>, то параметры передаются вызовом метода <span><strong>Run</strong></span>. То есть&nbsp; и <span><em>SubName</em></span> и&nbsp;
<span><em>ErrSubName</em></span> должны иметь одну и туже сигнатуру<span>.</span></p>


