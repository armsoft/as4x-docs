---
layout: page
title: "GetQueryPerformance"
---
    <style type="text/css">
        .style2 {
            color: #009900;
        }
        .style3 {
            color: #339933;
        }
        .style5 {
            color: #006699;
        }
        .style6 {
            font-size: x-small;
        }
        </style>





<p><strong>Пример работы функции GetQueryPerformanceCounter и GetQueryPerformanceFrequency</strong></p>

    <p>
        В примере вызываются функции <strong><em>GetQueryPerformanceCounter</em></strong> и <strong><em>GetQueryPerformanceFrequency</em></strong>
        для вычисления времени реализации программного кода в миллисекундах.<p>
Public Function TestQueryPerformanceCounter() As Currency<br>
&nbsp;&nbsp;&nbsp;
Dim ticksPerSecond As Currency<br>
&nbsp;&nbsp;&nbsp;
Dim ticksCount1 As Currency<br />
&nbsp;&nbsp;&nbsp; Dim ticksCount2 As Currency<br />
        <br />
&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;
ticksPerSecond = <a href="../Functions/Functions/GetQueryPerformanceFrequency.html">GetQueryPerformanceFrequency</a>()<br>
&nbsp;&nbsp;&nbsp;
ticksCount1 = <a href="../Functions/Functions/GetQueryPerformanceCounter.html">GetQueryPerformanceCounter</a>()<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; ...<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#39;Часть программного кода, время реализации которого нужно вычислить в миллисекундах<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...<br />
&nbsp;&nbsp;&nbsp; ticksCount2 = <a href="../Functions/Functions/GetQueryPerformanceCounter.html">GetQueryPerformanceCounter</a>()<br />
        <br />
&nbsp;&nbsp;&nbsp; &#39;Отнимаем от  <strong><em>
        ticksCount2</em></strong> - 
         <strong><em>ticksCount1</em></strong>, чтобы получить количество тиков часов работы той части програмнного кода, которое нас интересует,&nbsp;делим на <em> <strong>ticksPerSecond</strong></em> для получения времени в секундах и умножаем на 1000, чтобы получить время в миллисекундах. <br>
&nbsp;&nbsp;&nbsp;
TestQueryPerformanceCounter = (ticksCount2 - ticksCount1) * 1000 / ticksPerSecond<br>
End Function<br>
        <br>
</p>


