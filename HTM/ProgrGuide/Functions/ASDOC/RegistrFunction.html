---
layout: page
title: "Документ/RegistrFunction"
---
    <style type="text/css">
        .style1 {
            font-family: Arial;
        }
    </style>


<p><strong>Метод RegistrFunction<br>
</strong><br>
<a href="../Asdoc.html">См. также</a>&nbsp; <u>Пример</u>&nbsp; <a href="../Asdoc.html">Применяется к</a></p>

<p>Добавляет в контекстное меню вызов пользовательской функции. Данный метод обеспечивает выполнение пользовательской функции из любого вида просмотра, где находится документ.</p>

<p>&nbsp;</p>

<p><b>Синтаксис</b></p>

<p><em>object</em><strong>.RegistrFunction</strong>(<em>Caption,
</em>[<em>RunSub</em>]<em>, </em>[<em>AccessCode</em>]<em>, </em>[<em>ParentId</em>]<em>, </em>
[<em>ECaption</em>], [AvailableFor], [FuncParam])</p>

<p>Синтаксис метода <strong>RegistrFunction</strong>
состоит из следующих частей:</p>

<table border="1" cellPadding="5" cols="2" frame="below" rules="rows">
<TBODY>
  <tr>
    <td><b>Параметр</b></td>
    <td><strong>Описание</strong></td>
  </tr>
  <tr>
    <td><em>object</em></td>
    <td>строковое выражение, являющееся ссылкой на экземпляр документа</td>
  </tr>
  <tr>
    <td><em>Caption</em></td>
    <td>строковое выражение, определяющее заголовок функции добавляемой в контекстное меню. Значение &quot;-&quot; данного выражения означает добавление в меню, разделительной линии. </td>
  </tr>
  <tr>
    <td><em>RunSub</em></td>
    <td>необязательное строковое выражение, определяющее либо &quot;имя функции&quot;, либо &quot;имя модуля.имя функции&quot;, вызываемое при выборе данной строчки в контекстном меню. Если данный параметр не задан, то в контекстное меню добавляется разделитель.</td>
  </tr>
</TBODY>
  <tr>
    <td><em>AccessCode</em></td>
    <td>необязательное строковое выражение, определяющее идентификаторы рабочих мест на которых срабатывает данный вызов. При перечислении нескольких идентификаторов АРМ-ов они отделяются друг от друга символами &quot;;&quot;. Для пользователя, имеющего доступ хотя бы к одному из перечисленных АРМ-ов, данная функция будет доступна из всех АРМ-ов (даже не перечисленных!), где данный документ фигурирует.</td>
  </tr>
  <tr>
    <td><em>ParentId</em></td>
    <td>необязательное строковое выражение, определяющее ссылку <a href="RegistrNode.html">на идентификатор узла</a> дерева контекстных вызовов.</td>
  </tr>
  <tr>
    <td><em>ЕCaption</em></td>
    <td>необязательное строковое выражение, определяющее запись добавляемой в контекстное меню функции на иностранном языке. По умолчанию значение равно <em>Caption.</em></td>
  </tr>
    <tr>
    <td><em>AvailableFor</em></td>
    <td>необязательное цифровое выражение, определяющее 
	<a href="../../Constants/const_RegistrFunctionAvailability.html">константу видимости и иконку</a> контекстного меню.</td>
    </tr>
<tr>
    <td><em>FuncParam</em></td>
    <td>необязательное выражение типа Variant, определяющее параметр для функции заданной параметром <em>RunSub.</em></td>
  </tr>
</table>

<p>&nbsp;</p>

<p><b>Примечание</b></p>

<p>Данный метод должен быть вызван в обработчике системного события
<a href="../../ScriptProcs/FunctionsDoc.html">Functions</a>. Функция, срабатывающая при вызове, может быть описана либо в скриптовой части
    <a href="../../Defs/doc.html">
    документа</a>,&nbsp;либо в скриптовой части <a href="../../Defs/Module.html"> модуля</a>. Если описание функции находится в скриптовой части документа, то после его вызова срабатывает метод <a href="../FrmPttel/Update.html"> Update</a>&nbsp;по ISN-у документа, для которого она вызывается, в противном случае метод
    <a href="../FrmPttel/Update.html"> Update</a> не сработает.</p>
    <p>Рассмотрим следующие два примера:</p>
    <p>&nbsp;1.
        <span>
        <br />
        &#39; Скриптовая часть<em> Doc-а</em></span><br />
&nbsp; Sub Functions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Doc.RegistrFunction &quot;Operation&quot;, &quot;<strong>OperFunc</strong>&quot;<br />
&nbsp;&nbsp; End Sub<br />
&nbsp;&nbsp; Sub <strong>OperFunc</strong>()<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Doc(&quot;Rekv&quot;) = &quot;AAA&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Doc.Storе<br />
&nbsp;&nbsp; End Sub<br />
        <br />
        2.
        <br />
        <span>&#39; &nbsp;Скриптовая часть<em> Doc-а</em></span><br />
        <span>&nbsp; Sub Functions </span>
        <br />
        <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Doc.RegistrFunction &quot;Operation&quot;, &quot;<strong>Module.OperFunc</strong>&quot;</span><br />
        <span>&nbsp; End Subոո</span><br />
&nbsp;<br />
        <span>&#39; Скриптовая часть <em>Modulе-я</em></span><br />
        <span>&nbsp; Sub           <strong>OperFunc</strong>()</span><br />
        <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Doc(&quot;Rekv&quot;) = &quot;AAA&quot;</span><br />
        <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Doc.Store</span><br />
        <span>&nbsp; End Subb<br />
        <br Здесь, после вызова В первом примере описание функции находится в скриптовой части дукумента, во втором примере находится в скриптовой части модуля. При первом примере после 
        вызова функции сработает метод <a href="../FrmPttel/Update.html"> Update</a>, при втором примере не сработает.</span></p>
    <p>&nbsp;</p>
    <p>&nbsp;</p>
    <p>&nbsp;</p>

<p>&nbsp;</p>
