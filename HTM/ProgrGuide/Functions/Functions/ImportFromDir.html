---
layout: page
title: "ImportFromDir"
---


<p><strong>Метод</strong><strong> ImportFromDir<br>
</strong><a href="Import.html">См. также</a>&nbsp;
</p>

<p>Импортирует файлы в формате экспорта/импорта AS-3X из определенного каталога.<br>
&nbsp;</p>

<p><b>Синтаксис</b></p>

<p><strong>Util.ImportFromDir </strong><em>
sFolderName, sMoveToFolderName, sErrDocsFolder, sLogFileName, </em>[<em>sFileMask</em>]<em>, </em>
[<em>nErrCount</em>]<em>,&nbsp; </em>[<em>nFileCount</em>]<em>,</em>[<em>sDocList</em>]<em>, </em>
[<em>sTreeList</em>]<em>, </em>[<em>sParamList</em>]</p>

<p>Синтаксис функции <strong>ImportFromDir </strong>
состоит из следующих частей:</p>

<table border="1" cellPadding="5" cols="2" frame="below" rules="rows" width="758">
<TBODY>
  <tr>
    <td><b>Параметр</b></td>
    <td><strong>Описание</strong></td>
  </tr>
  <tr>
    <td><em>sFolderName</em></td>
    <td>строковое выражение, определяющее путь к каталогу из которого осуществляется импорт.</td>
  </tr>
  <tr>
    <td><em>sMoveToFolderName</em></td>
    <td>строковое выражение, определяющее путь к каталогу куда перемещаются принятые файлы.</td>
  </tr>
  <tr>
    <td><em>sErrDocsFolder</em></td>
    <td>строковое выражение, определяющее путь к каталогу в который будут записаны объекты при импорте которых произошла ошибка.</td>
  </tr>
  <tr>
    <td><em>sLogFileName</em></td>
    <td>строковое выражение, определяющее путь к файлу лога.</td>
  </tr>
  <tr>
    <td><em>sFileMask</em></td>
    <td>необязательное строковое выражение, определяющее маску импортируемых файлов. По умолчанию - &quot;*.txt&quot;.</td>
  </tr>
  <tr>
    <td><em>nErrCount</em></td>
    <td>необязательная переменная, возвращающая количество произошедших ошибок.</td>
  </tr>
  <tr>
    <td><em>nFileCount</em></td>
    <td>необязательная переменная, возвращающая количество рассмотренных файлов.</td>
  </tr>
  <tr>
    <td><em>sDocList</em></td>
    <td>необязательное строковое выражение, определяющее фильтр для документов. Если параметр не задан, то импортируются все документы. Для импорта только определенных типов нужно перечислить эти типы через запятую.</td>
  </tr>
  <tr>
    <td><em>sTreeList</em></td>
    <td>необязательное строковое выражение, определяющее фильтр для элементов дерева. Если параметр не задан, то импортируются все элементы дерева. Для импорта только определенных типов нужно перечислить эти типы через запятую. </td>
  </tr>
  <tr>
    <td><em>sParamList</em></td>
    <td>необязательное строковое выражение, определяющее фильтр для параметров. Если параметр не задан, то импортируются все параметры. Для импорта только определенных типов нужно перечислить эти типы через запятую.</td>
  </tr>
</table>

<p>&nbsp;</p>

<p><b>Примечание</b> </p>

<p><a href="Import.html">См. также</a></p>

<p>&nbsp;</p>

<p><b>Пример функции </b>
<strong>ImportFromDir</strong></p>

<p>Dim ErrCount As Long, FileCount as Long<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; call Util.ImportFromDir(&quot;C:\ImpFold&quot;, &quot;C:\InFold&quot;, &quot;C:\ErrFold&quot;, &quot;C:\log.txt&quot;, &quot;*.as&quot;, ErrCount, FileCount, &quot;MemOrd,Cli&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp; If ErrCount &gt; 0 Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AsMsgBox &quot;Imported with errors.&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp; Else<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AsMsgBox &quot;Succeed&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp; End If</p>

