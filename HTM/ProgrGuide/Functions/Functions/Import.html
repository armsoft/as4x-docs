---
layout: page
title: "Import"
---


<p><strong>Функция Import</strong></p>

<p>Импортирует <a href="../Asdoc.html">
документы</a>, <a href="../AsTreeElement.html">элементы дерева</a> и параметры из файла в формате экспорта/импорта AS-3X. Возвращает количество ошибок при импорте или -1, если файл не возможно импортировать.<br>
&nbsp;</p>

<p>Возвращаемое значение длинное целое.</p>

<p>&nbsp;</p>

<p><b>Синтаксис</b></p>

<p><strong>Util.Import (</strong><em>sFileName, sFailedFileName, xErrRepViewer, </em>[<em>sDocList</em>]<em>, </em>[<em>sTreeList</em>]<em>, </em>
[<em>sParamList</em>]<strong>)</strong></p>

<p>Синтаксис функции <strong>Import </strong>
состоит из следующих частей:</p>

<table border="1" cellPadding="5" cols="2" frame="below" rules="rows" width="758">
<TBODY>
  <tr>
    <td><b>Параметр</b></td>
    <td><strong>Описание</strong></td>
  </tr>
  <tr>
    <td><em>s</em><em>FileName</em></td>
    <td>строковое выражение, определяющее путь к файлу из которого осуществляется импорт.</td>
  </tr>
  <tr>
    <td><em>sFailedFileName</em></td>
    <td>строковое выражение, определяющее путь к файлу в который будут записаны объекты при импорте которых произошла ошибка.</td>
  </tr>
  <tr>
    <td><em>xErrRepViewer</em></td>
    <td>переменная, ссылающаяся на предварительно созданный экземпляр объекта <a href="../AsRepViewer.html">
    отчет</a>, в который добавляются сообщения об ошибках при импорте.</td>
  </tr>
  <tr>
    <td><em>sDocList</em></td>
    <td>необязательное строковое выражение, определяющее фильтр для документов. Если параметр не задан, то импортируются все документы. Для импорта только определенных типов нужно перечислить эти типы через запятую.</td>
  </tr>
  <tr>
    <td><em>sTreeList</em></td>
    <td>необязательное строковое выражение, определяющее фильтр для элементов дерева. Если параметр не задан, то импортируются все элементы дерева. Для импорта только определенных типов нужно перечислить эти типы через запятую. </td>
  </tr>
  <tr>
    <td><em>sParamList</em></td>
    <td>необязательное строковое выражение, определяющее фильтр для параметров. Если параметр не задан, то импортируются все параметры. Для импорта только определенных типов нужно перечислить эти типы через запятую.</td>
  </tr>
</table>

<p>&nbsp;</p>

<p><b>Примечание</b> </p>

<p><a href="../../functions.html">См. также</a></p>

<p>&nbsp;</p>

<p><b>Пример функции Import</b></p>

<p>Dim xRepVier As AsRepViewer<br>
Dim ErrCount As Long<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; ErrCount = Util.Import(&quot;C:\12.txt&quot;, &quot;C:\errDocs.txt&quot;, xRepVier, &quot;MemOrd,Cli&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp; If ErrCount = -1 Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AsMsgBox &quot;Invalid file&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp; ElseIf ErrCount &gt; 0 Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xRepVier.Show<br>
&nbsp;&nbsp;&nbsp;&nbsp; Else<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AsMsgBox &quot;Succeed&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp; End If</p>

