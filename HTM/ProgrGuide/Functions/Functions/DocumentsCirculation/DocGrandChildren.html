---
layout: page
title: "DocGrandChildren"
---
    <link rel="stylesheet" href="../../../../common.css" />
    <h2>Функция DocGrandChildren</h2>

    <p>
        Возвращает коллекцию внуков (значений ISN) для указанного документа. Если документ не имеет внуков, то функция возвращает Nothing. В коллекцию можно включить или исключить определенные типы документов внуков.
    </p>

    <h4>Синтаксис</h4>

    <p>
        <strong>DocGrandChildren</strong> (<em>ISN</em>, [<em>DocType1</em>], [<em>DocTypeLike1</em>], [<em>DocType2</em>], [<em>DocTypeLike2</em>])
    </p>

    <p>
        Синтаксис функции <strong>DocGrandChildren</strong>
        состоит из следующих частей:
    </p>

    <table>
        <thead>
            <tr>
                <th>Параметр</th>
                <th>Описание</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="param">ISN</td>
                <td>численное выражение типа Long, определяющее внутрисистемный идентификационный код ISN исходного документа, для которого приводятся потомки.</td>
            </tr>
            <tr>
                <td class="param">DocType1</td>
                <td>необязательное строковое выражение, определяющее тип искомых или исключаемых&nbsp; документов потомков. Если параметр не задан, то рассматриваются все потомки. Если нужно рассматривать только определенные типы документов, надо перечислить типы документов через пробел и значение параметра должно начинаться со знаком &quot;+&quot; (например - &quot;+KasPr MemOrd SetPr&quot;). Если необходимо рассматривать документы, за исключением некоторых типов, тогда&nbsp; для задания списка исключений значение параметра должно начинаться со знаком &quot;-&quot; . Например &quot;-AccDoc AsTurn&quot;.</td>
            </tr>
            <tr>
                <td class="param">DocTypeLike1</td>
                <td>необязательное строковое выражение, определяющее шаблон для искомых или исключаемых типов документов потомков. Если параметр не задан, то рассматриваются все потомки. Если надо рассматривать только определенные типы документов по шаблону, то нужно задать шаблон типов и значение параметра&nbsp;должно начинаться со знаком &quot;+&quot;. Если необходимо рассматривать документы, за исключением некоторых типов, тогда для задания списка исключений значение параметра должно начинаться со знаком &quot;-&quot; . Например &quot;-AccDoc%&quot;.</td>
            </tr>
            <tr>
                <td class="param">DocType2</td>
                <td>необязательное строковое выражение, определяющее тип возвращаемых или исключаемых документов внуков. Если параметр не задан, то приводятся коды ISN для всех типов внуков. Для включения в коллекцию документов определенных типов нужно перечислить типы документов через пробел и значение параметра&nbsp; должно начинаться со знаком &quot;+&quot;. Если в коллекцию необходимо включить документы, за исключением некоторых типов, тогда для задания списка исключений значение параметра должно начинаться со знаком &quot;-&quot; . Например &quot;-AccDocGrand AsTurnGrand&quot;.</td>
            </tr>
            <tr>
                <td class="param">DocTypeLike2</td>
                <td>необязательное строковое выражение, определяющее шаблон для возвращаемых или исключаемых типов документов внуков. Если параметр не задан, то приводятся&nbsp; коды ISN для всех типов внуков. Для включения в коллекцию документов определенных типов по шаблону нужно задать шаблон типов и значение параметра&nbsp; должно начинаться со знаком &quot;+&quot;. Если в коллекцию необходимо включить документы за исключением некоторых типов по шаблону, тогда&nbsp; для задания списка исключений значение параметра должно начинаться со сзнаком &quot;-&quot;. Например &quot;-AccDocGrand%&quot;.</td>
            </tr>
        </tbody>
    </table>

    <h4>Примечание</h4>
    <p>
        Интервал индексов элементов коллекции начинается с 1 до значения свойства Count коллекции.
    </p>

    <p><a href="../../../functions.html">См. также</a></p>

    <h4>Пример функции DocGrandChildren</h4>
    <p>
        Возвращается коллекция внуков для документа с ISN равным CredISN. Далее для каждого потомка вызывается функция GetCredSumJ.
    </p>

    <pre><code>Set xChilds = <strong>DocGrandChildren</strong>(CredISN)
CredSum = 0
CredSumJ = 0
For i=1 to xChilds.Count
  Call GetCredSumJ( xChilds(i), GetDate, xCredSum, xCredSumJ )
  CredSum = CredSum + xCredSum
  CredSumJ = CredSumJ + xCredSumJ
Next</code></pre>
