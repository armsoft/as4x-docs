---
layout: page
title: "DeleteDoc ֆունկցիա"
---

# DeleteDoc ֆունկցիա


Փաստաթուղթը նշում է որպես ջնջված կամ վերջնական ջնջում այն, վերադարձնելուվ True արժեքը, եթե գործողությունը հաջողվել է։ Ջնջելու դեպքում գեներացվում է [Delete](../../../ScriptProcs/Delete.html) համակարգային իրադարձությունը։ Եթե փաստաթուղթը ունի ժառանգներ, ապա ջնջումը թույլատրելի չի լինի։

Ջնջվում են փաստաթղթի հիման վրա ստեղծված հաշվառումները, ինչպես նաև փաստաթղթի օրինակները, որոնք տեղակայված են ծառերի, թղթապանակների և մնացորդների մեջ։ Ջնջումը տեղի է ունենում տրանզակցիայի միացված համակարգի դեպքում։

Помечает документ в качестве удаленного или же окончательно удаляет его, возвращая значение True, если действие удалось. При удалении генерируется системное событие [Delete](../../../ScriptProcs/Delete.html). Если документ имеет потомков, то удаление не допускается. Удаляются проводки, порожденные документом, а также экземпляры документа, помещенные в деревья, папки, остатки. Удаление производится при включенном механизме транзакции.

## Շարահյուսություն

```as4x
DeleteDoc (ISNorDoc, AllowUserInterface, [FullDelete], [Comment], [CallDelete], [InheritedDelete]) As Boolean
```

    
| Պարամետր | Նկարագրություն |
|--|--|
| ISNorDoc | Սահմանում է ջնջված փաստաթղթի ներհամակարգային ներքին նույնականացման համարի կոդը, կամ փաստաթղթի օրինակը։  выражение типа вариант, определяющее: либо внутрисистемный идентификационный код ISN удаляемого документа, либо же экземпляр документа. |
| AllowUserInterface |  Սահմանում է [երկխոսության պատուհանի](../InterfaceManagment/AsMsgBox.md) առաջացման նշանը, որը զգուշացնում է փաստաթղթի ջնջման և օգտագորժողի կողմից հաստատմանը սպասողի մասին։  логическое выражение, определяющее признак появления [диалогового окна](../InterfaceManagment/AsMsgBox.md), предупреждающего об удалении документа и ожидающего подтверждения от пользователя. |
| FullDelete | Փաստաթղթի վերջնական կամ միջանկյալ ջնջման նշան։ Լռությամբ արժեքը False է, ինչը և նշանակում է փաստաթղթի միջանկյալ ջնջումը։ Այսինքն այն ջնջվում է միայն հետևյալ աղյուսակներից՝ [DOCP](../../../Database/DocP.html), [FOLDERS](../../../Database/Folders.html), [TREES](../../../Database/Trees.html), [HIPAR](../../../Database/HiPar.html), [HIREST](../../../Database/Hirest.html), [HIREST2](../../../Database/Hirest2.html), [ACCESS](../../../Database/Access.html), [HI](../../../Database/Hi.html) և [HI2](../../../Database/Hi2.html), այսինքն հաշվառումներ որոնց մեջ ջնջվող փաստաթուղթը համարվում է հիմնական։ Այս դեպքում փաստաթուղթը մնում է  [DOCS](../../../Database/Docs.html), [DOCLOG](../../../Database/DocLog.html), [DOCSG](../../../Database/DocsG.html), [DOCSIM](../../../Database/Docsim.html) աղյուսակների մեջ և վիճակը կդառնա 999: Փաստաթղթի վերջնական ջնջման դեպքում նրա վերականգնումը անհնար կլինի, քանի որ նրա մասին հղումները/հիշատակումները ամենուրեք ջնջվելու են։ необязательное логическое выражение, определяющее признак окончательного, либо промежуточного удаления документа. По умолчанию принимает значение False, что означает промежуточное удаление документа. Т.е он удаляется только из таблиц [DOCP](../../../Database/DocP.html), [FOLDERS](../../../Database/Folders.html), [TREES](../../../Database/Trees.html), [HIPAR](../../../Database/HiPar.html), [HIREST](../../../Database/Hirest.html), [HIREST2](../../../Database/Hirest2.html), [ACCESS](../../../Database/Access.html), [HI](../../../Database/Hi.html), [HI2](../../../Database/Hi2.html) (те проводки, в которых удаляемый документ является документом-основанием). Документ в этом случае остается в таблицах [DOCS](../../../Database/Docs.html), [DOCLOG](../../../Database/DocLog.html), [DOCSG](../../../Database/DocsG.html), [DOCSIM](../../../Database/Docsim.html), и его состояние переходит в 999. В случае же окончательного удаления документа дальнейшее его восстановление невозможно, т.к. все упоминания о нем окончательно отовсюду удаляются. |
| Comment | Փաստաթղթի վրա կատարվող գործողությունների գրանցամատյանում գրանցվող հաղորդագրություն։ необязательное строковое выражение, определяющее сообщение, которое будет записано в журнале регистрации операций над документом |
| CallDelete | Փաստաթղթի [Delete](../../../ScriptProcs/Delete.html) իրադարձությունը կանչելու նշան։ Լռությամբ արժեքը `True` է։ необязательное логическое выражение, определяющее признак вызова события документа [Delete](../../../ScriptProcs/Delete.html). По умолчанию принимает значение True, что означает вызов данного события. |
| InheritedDelete | `True` արժեքի դեպքում փաստաթղթի պատմության մեջ գրվում է, որ փաստաթուղթը ջնջվել է այլ փաստաթղթի ջնջման ընթացքում։ Տվյալների պահոցում ջնջման կոդը լինում է `H`։  |


## Նկատառումներ

[տես նաև](LoadDoc.html)

DeleteDoc ֆունկցիայի օրինակ

1. Փաստաթուղթը ջնջվում է առանց երկխոսության պատուհանի հաստատման ։
1. Удаляется документ, без ожидающего подтверждения диалогового окна.

`isdel = DeleteDoc(xDoc.ISN, False)`

2. docDel-ի ջնջման դեպքում կգրվի՝ 
2. При таком удалении в логе docDel будет написано<br />
(Հայերեն) Հեռացման հիմք փաստաթուղթ` 123654789<br />
(Անգլերեն) Deletion Base Document: 123654789

`Call DeleteDoc(docDel, False, , "123654789", , True)`
