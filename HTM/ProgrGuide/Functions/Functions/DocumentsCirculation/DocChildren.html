---
layout: page
title: "DocChildren"
---
    <link rel="stylesheet" href="../../../../common.css" />
    <h2>Функция DocChildren</h2>

    <p>
        Возвращает коллекцию потомков (значений ISN) для указанного документа. Если документ не имеет потомков, то функция возвращает Nothing. В коллекцию можно включить или исключить определенные типы документов потомков.
    </p>

    <h4>Синтаксис</h4>

    <p>
        <strong>DocChildren</strong> (<em>ISN</em>, [<em>DocType</em>], [<em>nOrder</em>], [<em>DocTypeLike</em>])
    </p>

    <p>Синтаксис функции <strong>DocChildren </strong>состоит из следующих частей:</p>

    <table>
        <thead>
            <tr>
                <th>Параметр</th>
                <th>Описание</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="param">ISN</td>
                <td>численное выражение типа Long, определяющее внутрисистемный идентификационный код ISN исходного документа, для которого приводятся потомки.</td>
            </tr>
            <tr>
                <td class="param">DocType</td>
                <td>необязательное строковое выражение, определяющее тип возвращаемых или исключаемых типов документов потомков. Если параметр не задан, то приводятся коды ISN для всех типов потомков. Для включения в коллекцию документов определенных типов, нужно перечислить типы документов через пробел и значение параметра&nbsp; должно начинаться со знаком &quot;+&quot;. Например для включения в коллекцию потомков 3х типов документов нужно задать: &quot;+KasPr MemOrd SetPr&quot;. Если в коллекцию необходимо включить документы, за исключением некоторых типов, тогда для задания списка исключений значение параметра должно начинаться со знаком &quot;-&quot; . Например &quot;-AccDoc AsTurn&quot;.</td>
            </tr>
            <tr>
                <td class="param">nOrder</td>
                <td>необязательное численное выражение, определяющее порядок сортировки ISN потомков по дате создания документа. При значении <strong>0</strong> элементы упорядочиваются по убыванию даты создания документа, при значении <strong>1</strong> - по возрастанию, а при значения <strong>-1</strong> сортировки не происходит вообще. По умолчанию принимает значение 
                    <strong>0</strong>.</td>
            </tr>
            <tr>
                <td class="param">DocTypeLike</td>
                <td>необязательное строковое выражение, определяющее шаблон для возвращаемых или исключаемых типов документов потомков. Если параметр не задан, то приводятся&nbsp; коды ISN для всех типов потомков. Для включения в коллекцию документов определенных типов по шаблону, нужно задать шаблон типов и значение параметра&nbsp; должно начинаться со знаком &quot;+&quot;. Если в коллекцию необходимо включить документы, за исключением некоторых типов по шаблону, тогда для задания списка исключений значение параметра должно начинаться со знаком &quot;-&quot; . Например &quot;-AccDoc%&quot;.</td>
            </tr>
        </tbody>
    </table>

    <h4>Примечание</h4>
    <p>Интервал индексов элементов коллекции начинается с 1 до значения свойства Count коллекции.</p>

    <p><a href="../../../functions.html">См. также</a></p>

    <h4>Пример функции DocChildren</h4>
    <p>
        Возвращается коллекция потомков для документа с ISN равным CredISN. Далее для каждого потомка вызывается функция GetCredSumJ.
    </p>

    <pre><code>Set xChilds = <strong>DocChildren</strong>(CredISN)
CredSum = 0
CredSumJ = 0
For i=1 to xChilds.Count
    Call GetCredSumJ( xChilds(i), GetDate, xCredSum, xCredSumJ )
    CredSum = CredSum + xCredSum
    CredSumJ = CredSumJ + xCredSumJ
Next</code></pre>
