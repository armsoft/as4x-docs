---
layout: page
title: "DocGrandChildren ֆունկցիա"
---

# DocGrandChildren ֆունկցիա

Նշված փաստաթղթի համար վերադարձնում է թոռների հավաքածուն։ Եթե փաստաթուղթը թոռներ չունի, ապա ֆունկցիան վերադաձնում է Nothing։ Հավաքածուի մեջ կարելի է ներառել և հեռացնել թոռ ծառերի սահմանված տիպերը։ 
Возвращает коллекцию внуков (значений ISN) для указанного документа. Если документ не имеет внуков, то функция возвращает Nothing. В коллекцию можно включить или исключить определенные типы документов внуков.


## Շարահյուսություն

```vb
DocGrandChildren (ISN, [DocType1], [DocTypeLike1], [DocType2], [DocTypeLike2])
```

Բաղադրիչներն են՝

    
| Պարամետր | Նկարագրություն |
|--|--|
| ISN | Հիմնական փաստաթղթի ISN, որի համար էլ սահմանվում են ժառանգներ։ численное выражение типа Long, определяющее внутрисистемный идентификационный код ISN исходного документа, для которого приводятся потомки. |
| DocType1 | Հիմնական կամ հեռացված փաստաթղթերի զավակների տիպը։ Եթե պարամետրը տրված չի, ապա դիտարկվում/սահմանվում են բոլոր զավակները։ Եթե անհրաժեշտ է սահմանել որոշ փաստաթղթերի տիպեր, հարկավոր է թվարկել փաստաթղթերի տիպերը բացակների միջոցով և պարամետրի արժեքը պետք է սկսի `+` նշանով (օրինակ՝ `+KasPr MemOrd SetPr`)։ Եթե հարկավոր է սահմանել փաստաթղթերը, բացի մի քանի տեսակից, այդ դեպքում պարամետրի արժեքների ցանկը ստեղծելու համար պետք է սկսվի `-`  նշանով (Օրինակ՝ `-AccDoc AsTurn&quot`)։  необязательное строковое выражение, определяющее тип искомых или исключаемых документов потомков. Если параметр не задан, то рассматриваются все потомки. Если нужно рассматривать только определенные типы документов, надо перечислить типы документов через пробел и значение параметра должно начинаться со знаком &quot;+&quot; (например - &quot;+KasPr MemOrd SetPr&quot;). Если необходимо рассматривать документы, за исключением некоторых типов, тогда для задания списка исключений значение параметра должно начинаться со знаком &quot;-&quot; . Например &quot;-AccDoc AsTurn&quot;. |
| DocTypeLike1 | Հիմնական կամ հեռացվող փաստաթղթերի տեսակների զավակների ձևաչափ։ Եթե պարամետրը տրված չի, ապա դիտարկվում/սահմանվում են բոլոր զավակները։ Եթե անհրաժեշտ է սահմանել որոշ փաստաթղթերի տիպեր, հարկավոր է թվարկել փաստաթղթերի տիպերը բացակների միջոցով և պարամետրի արժեքը պետք է սկսի `+` նշանով։ Եթե հարկավոր է սահմանել փաստաթղթերը, բացի մի քանի տեսակից, այդ դեպքում պարամետրի արժեքների ցանկը ստեղծելու համար պետք է սկսվի `-`  նշանով (Օրինակ՝ `AccDoc%`)։ необязательное строковое выражение, определяющее шаблон для искомых или исключаемых типов документов потомков. Если параметр не задан, то рассматриваются все потомки. Если надо рассматривать только определенные типы документов по шаблону, то нужно задать шаблон типов и значение параметра&nbsp;должно начинаться со знаком &quot;+&quot;. Если необходимо рассматривать документы, за исключением некоторых типов, тогда для задания списка исключений значение параметра должно начинаться со знаком &quot;-&quot; . Например &quot;-AccDoc%&quot;. |
| DocType2 | Հիմնական կամ հեռացվող փաստաթղթերի տեսակների զավակների տիպը։ Եթե պարամետրը տրված չի, ապա սահմանվում են բոլոր տիպի զավակների ISN-ները։ հավաքածուի մեջ որոշ տիպի փաստաթղթերի մուտքի համար հարկավոր է թվարկել փաստաթղթերի տիպերը բացակների միջոցով և պարամետրի արժեքը պետք է սկսվի `+` նշանով։ Եթե հավաքածուի մեջ անհրաժեշտ է ներառել որոշ տիպի փաստաթղթեր, ապա պարամետրի արժեքների ցանկը ստեղծելու համար պետք է սկսվի `-`  նշանով (Օրինակ՝ `-AccDocGrand AsTurnGrand`)։  необязательное строковое выражение, определяющее тип возвращаемых или исключаемых документов внуков. Если параметр не задан, то приводятся коды ISN для всех типов внуков. Для включения в коллекцию документов определенных типов нужно перечислить типы документов через пробел и значение параметра должно начинаться со знаком &quot;+&quot;. Если в коллекцию необходимо включить документы, за исключением некоторых типов, тогда для задания списка исключений значение параметра должно начинаться со знаком &quot;-&quot; . Например &quot;-AccDocGrand AsTurnGrand&quot;. |
| DocTypeLike2 | Հիմնական կամ հեռացվող փաստաթղթերի տեսակների զավակների ձևաչափը։ Հավաքածուի մեջ ըստ փաստաթղթի ձևաչափի հարկավոր է սահմանել տիպերի ձևաչափ և պարամետրի արժեքը պետք է սկսվի `+` նշանով։ Եթե հավաքածուի մեջ հարկավոր է ներառել փաստաթղթեր, բացառությամբ ըստ ձևաչափի որոշ տիպերի  , ապա բացառությունների ցանկը սահմանելիս պարամետրի արժեքը պետք է սկսվի `+` նշանով(օրինակ՝ `-AccDocGrand`): необязательное строковое выражение, определяющее шаблон для возвращаемых или исключаемых типов документов внуков. Если параметр не задан, то приводятся&nbsp; коды ISN для всех типов внуков. Для включения в коллекцию документов определенных типов по шаблону нужно задать шаблон типов и значение параметра должно начинаться со знаком &quot;+&quot;. Если в коллекцию необходимо включить документы за исключением некоторых типов по шаблону, тогда&nbsp; для задания списка исключений значение параметра должно начинаться со сзнаком &quot;-&quot;. Например &quot;-AccDocGrand%&quot;. |


## Նկատառումներ

Հավաքածուի տարրերի միջակայքը սկսվում է 1-ից մինչև Count հավաքածուի հատկությունների արժեքները։
Интервал индексов элементов коллекции начинается с 1 до значения свойства Count коллекции.


[Տես նաև](../../../functions.html)

## Օրինակ

Վերադարձնում է զավակների հավաքածուն, փաստաթղթի համար, որի ISN-ը հավասար է GetCredSumJ-ի։
Возвращается коллекция внуков для документа с ISN равным CredISN. Далее для каждого потомка вызывается функция GetCredSumJ.

```vb
Set xChilds = DocGrandChildren(CredISN)
CredSum = 0
CredSumJ = 0
For i=1 to xChilds.Count
  Call GetCredSumJ( xChilds(i), GetDate, xCredSum, xCredSumJ )
  CredSum = CredSum + xCredSum
  CredSumJ = CredSumJ + xCredSumJ
Next
```
